\documentclass[10pt,a4paper, margin=1in]{article}
\usepackage{fullpage}
\usepackage{amsfonts, amsmath, pifont}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{float}
\usepackage{minted}
\usepackage{tkz-euclide}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{circuitikz}
\pgfplotsset{compat=1.13}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={210mm,297mm},
 left=10mm,
 right=10mm,
 top=10mm,
 bottom=10mm,
 }
 \author{
  Geçit, Emre\\
  \texttt{e2521581@ceng.metu.edu.tr}
  \and
  Yancı, Baran\\
  \texttt{e2449015@ceng.metu.edu.tr}
}

\title{CENG 384 - Signals and Systems for Computer Engineers \\
Spring 2023 \\
Homework 4}
\begin{document}
\maketitle



\noindent\rule{19cm}{1.2pt}

\begin{enumerate}

\item %write the solution of q1
	\begin{enumerate}   
    % Write your solutions in the following items.
    \item %write the solution of q1a
    \begin{align*}
        H(j\omega) &= \frac{j\omega - 1}{j\omega + 1} \\
        \frac{Y(j\omega)}{X(j\omega)} &= \frac{j\omega - 1}{j\omega + 1} \\
        Y(j\omega)(j\omega + 1) &= X(j\omega)(j\omega - 1) \\
        y'(t) + y(t) &= x'(t) - x(t) \\
    \end{align*}
    \item %write the solution of q1b
    % find the impulse response
    \begin{align*}
        H(j\omega) &= \frac{j\omega - 1}{j\omega + 1} \\
        h(t) &= \mathcal{F}^{-1}\{H(j\omega)\} \\
        &= \mathcal{F}^{-1}\{\frac{j\omega - 1}{j\omega + 1}\} \\
        &= \mathcal{F}^{-1}\{\frac{j\omega + 1 - 2}{j\omega + 1}\} \\
        &= \mathcal{F}^{-1}\{\frac{j\omega + 1}{j\omega + 1}\} - \mathcal{F}^{-1}\{\frac{2}{j\omega + 1}\} \\
        &= \mathcal{F}^{-1}\{1\} - 2\mathcal{F}^{-1}\{\frac{1}{j\omega + 1}\} \\
        &= \delta(t) - 2e^{-t}u(t) \\
    \end{align*}
	\item %write the solution of q1c
    % find and plot the output for the input x(t) = e^{-2t}u(t)
    \begin{align*}
        y'(t) + y(t) &= x'(t) - x(t) \\
        y'(t) + y(t) &= -2e^{-2t}u(t) - e^{-2t}u(t) \\
        y'(t) + y(t) &= -3e^{-2t}u(t) \\
        y_p(t) &= Ae^{-2t} \\
        y_p'(t) &= -2Ae^{-2t} \\
        -2Ae^{-2t} + Ae^{-2t} &= -3e^{-2t}u(t) \\
        A &= 3 \\
        y_p(t) &= 3e^{-2t} \\
        y_h(t) &= c_1e^{-t}u(t) \\
        y(t) &= y_p(t) + y_h(t) \\
        &= 3e^{-2t} + c_1e^{-t}u(t) \\
        y(0) &= 0 \\
        0 &= 3e^{-2(0)} + c_1e^{-0}u(0) \\
        0 &= 3 + c_1 \\
        c_1 &= -3 \\
        y(t) &= 3e^{-2t} - 3e^{-t}u(t) \\
    \end{align*}
    \item Block diagram of the system:

        \begin{figure}[H]
            \centering
            \resizebox{0.6\textwidth}{!}{%
            \begin{circuitikz}
            \tikzstyle{every node}=[font=\LARGE]
            \node [font=\LARGE] at (1.25,12.75) {x(t)};
            \draw [](2.75,12.75) to[short] (2.75,11.25);
            \draw  (2,11.25) rectangle (3.5,10);
            \node [font=\LARGE] at (2.8, 10.63) {$\int$};
            \draw  (2,11.25) rectangle  (3.5,10);
            \draw  (5.5,9) circle (0.5cm);
            \draw [](2.75,9) to[short] (2.75,10);
            \draw [](5.5,9.25) to[short] (5.5,8.75);
            \draw [](5.25,9) to[short] (5.75,9);
            \draw [ -Stealth] (2.75,9) -- (5,9);
            \draw [ -Stealth] (5.5,9.5) -- (5.5,12.25);
            \node [font=\LARGE] at (10.25,12.75) {y(t)};
            \draw [ -Stealth] (6,12.75) -- (9.5,12.75);
            \draw  (5.5,12.75) circle (0.5cm);
            \draw [short] (5.5,13) -- (5.5,12.5);
            \draw [short] (5.25,12.75) -- (5.75,12.75);
            \draw [short] (3.5,9.25) -- (3.75,9.25);
            \draw [short] (7.25,9.25) -- (7.5,9.25);
            \draw [ -Stealth] (8.25,9) -- (6,9);
            \draw  (7.5,11.25) rectangle (9,10);
            \draw [short] (8.25,12.75) -- (8.25,11.25);
            \draw [short] (8.25,9) -- (8.25,10);
            \node [font=\LARGE] at (8.25,10.63) {$\int$};
            \draw [ -Stealth] (1.75,12.75) -- (5,12.75);
            \end{circuitikz}
            }
            \caption{Block Diagram of the System}
        \end{figure}

    \end{enumerate}

\item %write the solution of q2  
	\begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q2a
    \begin{align*}
        y[n + 1] - \frac{1}{2}y[n] &= x[n + 1] \\ 
        e^{j\omega}Y(e^{j\omega}) - \frac{1}{2}Y(e^{j\omega}) &= e^{j\omega}X(e^{j\omega}) \\
        H(e^{j\omega}) &= \frac{Y(e^{j\omega})}{X(e^{j\omega})} \\
        H(e^{j\omega}) &= \frac{e^{j\omega}}{e^{j\omega} - \frac{1}{2}} \\
    \end{align*}
    \item %write the solution of q2b
    % fiind the impulse response
    \begin{align*}
        H(e^{j\omega}) &= \frac{e^{j\omega}}{e^{j\omega} - \frac{1}{2}} \\
        h[n] &= \mathcal{F}^{-1}\{H(e^{j\omega})\} \\
        &= \mathcal{F}^{-1}\{\frac{e^{j\omega}}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \mathcal{F}^{-1}\{\frac{e^{j\omega} - \frac{1}{2} + \frac{1}{2}}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \mathcal{F}^{-1}\{\frac{e^{j\omega} - \frac{1}{2}}{e^{j\omega} - \frac{1}{2}} + \frac{\frac{1}{2}}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \mathcal{F}^{-1}\{1 + \frac{\frac{1}{2}}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \mathcal{F}^{-1}\{1\} + \mathcal{F}^{-1}\{\frac{\frac{1}{2}}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \delta[n] + \frac{1}{2}\mathcal{F}^{-1}\{\frac{1}{e^{j\omega} - \frac{1}{2}}\} \\
        &= \delta[n] + \frac{1}{2}e^{\frac{1}{2}n}u[n] \\
    \end{align*}
	\item %write the solution of q2c
    % find and plot the output for the input x[n] = \left(\frac{3}{4}\right)^nu[n]
    The initial condition is $y[a] = 0, a \leq -1$.
    \begin{align*}
        y[n + 1] - \frac{1}{2}y[n] &= x[n + 1] \\
        y[n + 1] &= \frac{1}{2}y[n] + x[n + 1] \\
        y[0] &= \frac{1}{2}y[-1] + x[0] \\
        &= 0 + 1 \\
        &= 1 \\
        y[1] &= \frac{1}{2}y[0] + x[1] \\
        &= \frac{1}{2} + \frac{3}{4} \\
        &= \frac{5}{4} \\
        y[2] &= \frac{1}{2}y[1] + x[2] \\
        &= \frac{5}{8} + \frac{9}{16} \\
        &= \frac{19}{16} \\
        y[3] &= \frac{1}{2}y[2] + x[3] \\
        &= \frac{19}{32} + \frac{27}{64} \\
        &= \frac{65}{64} \\
        y[4] &= \frac{1}{2}y[3] + x[4] \\
        &= \frac{65}{128} + \frac{81}{256} \\
        &= \frac{211}{256} \\
        &...\\
        % general rule
        y[n] &= 2^{-n}\left(1 + 3\left( \left(\frac{3}{2}\right)^n - 1 \right)\right)
    \end{align*}
    \end{enumerate}

\item %write the solution of q3
	\begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q3a
    \begin{align*}
        H(j\omega) &= H_1(j\omega)H_2(j\omega) \\
        &= \frac{1}{j\omega + 1}\frac{1}{j\omega + 2} \\
        &= \frac{Y(j\omega)}{X(j\omega)} \\
        Y(j\omega)(j\omega + 1)(j\omega + 2) &= X(j\omega) \\
        Y(j\omega)(j^2\omega^2 + 3j\omega + 2) &= X(j\omega) \\
        y''(t) + 3y'(t) + 2y(t) &= x(t) \\
    \end{align*}
    \item %write the solution of q3b
    \begin{align*}
        H(j\omega) &= H_1(j\omega)H_2(j\omega) \\
        H_1(j\omega) &= \frac{1}{j\omega + 1} \\
        H_2(j\omega) &= \frac{1}{j\omega + 2} \\
        H(j\omega) &= \frac{1}{j\omega + 1}\frac{1}{j\omega + 2} \\
        h_1(t) &= \mathcal{F}^{-1}\{H(j\omega)\} \\
        &= \mathcal{F}^{-1}\{\frac{1}{j\omega + 1}\frac{1}{j\omega + 2}\} \\
        &= \mathcal{F}^{-1}\{\frac{1}{j\omega + 1}\} * \mathcal{F}^{-1}\{\frac{1}{j\omega + 2}\} \\
        &= e^{-t}u(t) * e^{-2t}u(t) \\
        &= \int_{-\infty}^{\infty}e^{-(t - \tau)}u(t - \tau)e^{-2\tau}u(\tau)d\tau \\
        &= \int_{0}^{t}e^{-(t - \tau)}e^{-2\tau}d\tau \\
        &= \int_{0}^{t}e^{-t + \tau}e^{-2\tau}d\tau \\
        &= \int_{0}^{t}e^{-t}e^{\tau}e^{-2\tau}d\tau \\
        &= e^{-t}\int_{0}^{t}e^{-\tau}d\tau \\
        &= e^{-t}\left[-e^{-\tau}\right]_{0}^{t} \\
        &= e^{-t}\left[-e^{-t} + 1\right] \\
        &= e^{-t} - e^{-2t} \\
    \end{align*}
	\item %write the solution of q3c
    \begin{align*}
        X(j\omega) &= j\omega \\
        Y(j\omega) &= H(j\omega)X(j\omega) \\
        &= \frac{1}{j\omega + 1}\frac{1}{j\omega + 2}j\omega \\
        y(t) &= \mathcal{F}^{-1}\{Y(j\omega)\} \\
        &= \mathcal{F}^{-1}\{\frac{j\omega}{(j\omega + 1)(j\omega + 2)}\} \\
        &= \mathcal{F}^{-1}\{\frac{-1}{j\omega + 1} + \frac{2}{j\omega + 2}\} \\
        &= \mathcal{F}^{-1}\{\frac{-1}{j\omega + 1}\} + \mathcal{F}^{-1}\{\frac{2}{j\omega + 2}\} \\
        &= -e^{-t}u(t) + 2e^{-2t}u(t) \\
    \end{align*}
    \end{enumerate}

\item %write the solution of q4
    \begin{enumerate}   
    \item \begin{align*}
    H(e^{j\omega}) & = \frac{Y(e^{j\omega})}{X(e^{j\omega})} = \frac{5e^{-j\omega} + 12}{e^{-2j\omega}+5e^{-j\omega}+6} && \text{Found in part 4b} \\
        Y(e^{j\omega})(e^{-2j\omega}+5e^{-j\omega}+6) &= X(e^{j\omega})(5e^{-j\omega} + 12) \\
        y[n-2] + 5y[n-1] + 6y[n] &= 5x[n-1] + 12x[n] \\
    \end{align*}
    \item \begin{align*}
        H(e^{j\omega}) &= H_1(e^{j\omega}) + H_2(e^{j\omega}) \\
        &= \frac{3}{3+e^{-j\omega}} + \frac{2}{2+e^{-j\omega}} \\
        &= \frac{5e^{-j\omega} + 12}{e^{-2j\omega}+5e^{-j\omega}+6} \\
    \end{align*}
	\item \begin{align*}
        h[n] &= \mathcal{F}^{-1}\{H_1(j\omega) + H_2(j\omega)\}\\
        &= \mathcal{F}^{-1}\{\frac{3}{3+e^{-j\omega}} + \frac{2}{2+e^{-j\omega}}\}\\
        &= \mathcal{F}^{-1}\{\frac{3}{3+e^{-j\omega}}\} + \mathcal{F}^{-1}\{\frac{2}{2+e^{-j\omega}}\}\\
        &= \frac{-1}{3} u[n] + \frac{1}{2} u[n] \\
    \end{align*}
    \end{enumerate}

\item After decoding \textbf{encoded.wav} according to the recipe given, a wav file \textbf{decoded.wav} is obtained.
When played by a media player, the decoded file says "I have a dream".

\begin{figure}[H]
    \centering
    \input{figures/encoded.pgf}
    \caption{Time Domain Representation of The Encoded Signal}
\end{figure}

\begin{figure}[H]
    \centering
    \input{figures/dft_encoded.pgf}
    \caption{Frequency Domain Representation of The Encoded Signal}
\end{figure}

\begin{figure}[H]
    \centering
    \input{figures/dft_decoded.pgf}
    \caption{Frequency Domain Representation of The Decoded Signal}
\end{figure}

\begin{figure}[H]
    \centering
    \input{figures/decoded.pgf}
    \caption{Time Domain Representation of The Decoded Signal}
\end{figure}


The code for the decoding process is given below.
\inputminted{python}{hw4.py}


\end{enumerate}


\end{document}


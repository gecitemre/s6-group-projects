\documentclass[10pt,a4paper, margin=1in]{article}
\usepackage{fullpage}
\usepackage{subcaption}
\usepackage{amsfonts, amsmath, pifont}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{tkz-euclide}
\usepackage{tikz}
\usepackage{minted}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={210mm,297mm},
 left=10mm,
 right=10mm,
 top=20mm,
 bottom=20mm,
 }
 % Write both of your names here. Fill exxxxxxx with your ceng mail address.
 \author{
  Geçit, Emre\\
  \texttt{e2521581@ceng.metu.edu.tr}
  \and
  Yancı, Baran\\
  \texttt{e2449015@ceng.metu.edu.tr}
}

\title{CENG 384 - Signals and Systems for Computer Engineers \\
Spring 2023 \\
Homework 1}
\begin{document}
\maketitle



\noindent\rule{19cm}{1.2pt}

\begin{enumerate}

\item %write the solution of q1
    \begin{enumerate}
    % Write your solutions in the following items.
    \item \begin{align*}
            &z = x + yj \implies \bar{z} = x - yj \\
            &2z + 5 = j - \bar{z} \\
            &2(x + yj) + 5 = j - (x - yj) \\
            &2x + 5 + 2yj = (1 + y)j - x \\
            &y = 1, x = \frac{-5}{3} \\
            &z = \frac{-5}{3} + j\\
            &|z|^2 = \frac{25}{9} + 1 = \frac{34}{9}
    \end{align*}

    % \includegraphics*[width=0.5\textwidth]{q1a.png}

    \begin{center}
        \begin{tikzpicture}

            \pgfplotsset{
                scale only axis,
            }
        
            \begin{axis}[
            xlabel=$real$,
            ylabel=$imaginary$,
            grid = both,
            xmin=-2, xmax=-1,
            ]
            \addplot[only marks, mark=*]
            coordinates{
                (-1.66, 1)
            }; \label{z}
        
                \addlegendimage{/pgfplots/refstyle=plot_one}
            \addlegendentry{z}
            \end{axis}
        
        \end{tikzpicture}
    \end{center}
      
        
    \item \begin{align*}
        & z = re^{j\theta} \implies z^5 = r^5e^{j5\theta} \\
        & 32j = 32e^{j\pi/2} \\
        & 32e^{j\pi/2} = r^5e^{j5\theta} \implies r = 2, \theta = \pi/10 \\
        & z = 2e^{j\pi/10}
    \end{align*}
    \item \begin{align*}
        z & = \frac{(1 + j) (\frac{1}{2} + \frac{\sqrt{3}}{2}) j}{j - 1} \\
        & = \frac{(j + 1) (1 + j) (\frac{1}{2} + \frac{\sqrt{3}}{2}) j}{(j + 1) (j - 1)} \\
        & = \frac{{(j + 1)}^2 (\frac{1}{2} + \frac{\sqrt{3}}{2})}{-2} \\
        & = \frac{(j^2 + 2j + 1) (\frac{1}{2} + \frac{\sqrt{3}}{2})}{-2} \\
        & = \frac{(-1 + 2j + 1) (\frac{1}{2} + \frac{\sqrt{3}}{2})}{-2} \\
        & = \frac{2j (\frac{1}{2} + \frac{\sqrt{3}}{2})}{-2} \\
        & = -j (\frac{1}{2} + \frac{\sqrt{3}}{2}) \\
        z & = r \cos\theta + r \sin\theta j \\
        j (- \frac{1}{2} - \frac{\sqrt{3}}{2}) & = r \cos\theta + r \sin\theta j \\
        r\cos\theta & = 0 \\
        r\sin\theta & = - \frac{1}{2} - \frac{\sqrt{3}}{2} \\
        \cos\theta & = 0 \\
        \sin\theta & = -1 \\
        r & = \frac{1}{2} + \frac{\sqrt{3}}{2} \\
        \theta & = -\pi/2 \\
    \end{align*}
    \item \begin{align*}
        z & = je^{-j\pi/2} \\
        & = e^{j\pi/2}e^{-j\pi/2} \\
        & = e^0 = 1
    \end{align*}
    \end{enumerate}

\newpage % start a new page so that the layout of the graph is not messed up.
\item %write the solution of q2
    The graph of the function is given below.
    \begin{center}
        \includegraphics*[width=0.5\textwidth]{assets/graphs/q2.png}
    \end{center}

\item %write the solution of q3
    \begin{enumerate}
    % Write your solutions in the following items.
    \item
        The graph of the function $x[-n] + x[2n - 1]$ is given below.
        \begin{center}
            \includegraphics*[width=0.5\textwidth]{assets/graphs/q3a.png}
        \end{center}
    \item \begin{align*}
        & x[n] =  -\delta[n-1] + 2\delta[n-2] + -4\delta[n-4] + 3\delta[n-7] \\
        & x[-n] = -\delta[-n-1] + 2\delta[-n-2] + -4\delta[-n-4] + 3\delta[-n-7] \\
        & x[2n-1] = -\delta[2n-2] + 2\delta[2n-3] + -4\delta[2n-5] + 3\delta[2n-8] \\
        & x[-n] + x[2n-1] = -\delta[-n-1] + 2\delta[-n-2] -4\delta[-n-4] + 3\delta[-n-7] -\delta[2n-2] + 2\delta[2n-3] \\
        & -4\delta[2n-5] + 3\delta[2n-8] \\
    \end{align*}
    
    
    \end{enumerate}

\item %write the solution of q4
    \begin{enumerate}
    \item \begin{align*}
        x(t) & = x(t + t_0) \\
        5\sin(3t - \frac{\pi}{4}) & = 5\sin(3(t + t_0) - \frac{\pi}{4})\\
        \sin(3t - \frac{\pi}{4}) & = \sin(3t + 3t_0 - \frac{\pi}{4})\\
        \sin(3t - \frac{\pi}{4}) & = \sin(3t) \cos(3t_0 - \frac{\pi}{4}) + \cos(3t) \sin(3t_0 - \frac{\pi}{4})\\
        \sin(3t) \cos(- \frac{\pi}{4}) + \cos(3t) \sin(- \frac{\pi}{4}) & = \sin(3t) \cos(3t_0 - \frac{\pi}{4}) + \cos(3t) \sin(3t_0 - \frac{\pi}{4})\\
        \sin(3t) \frac{\sqrt{2}}{2} - \cos(3t) \frac{\sqrt{2}}{2} & = \sin(3t) \cos(3t_0 - \frac{\pi}{4}) + \cos(3t) \sin(3t_0 - \frac{\pi}{4})\\
        \sin(3t) \frac{\sqrt{2}}{2} - \sin(3t) \cos(3t_0 - \frac{\pi}{4}) & = \cos(3t) \frac{\sqrt{2}}{2} + \cos(3t) \sin(3t_0 - \frac{\pi}{4})\\
        \sin(3t) \left(\frac{\sqrt{2}}{2} - \cos(3t_0 - \frac{\pi}{4})\right) & = \cos(3t) \left(\frac{\sqrt{2}}{2} + \sin(3t_0 - \frac{\pi}{4})\right)\\
        \frac{\sqrt{2}}{2} - \cos(3t_0 - \frac{\pi}{4}) & = 0\\
        \frac{\sqrt{2}}{2} + \sin(3t_0 - \frac{\pi}{4}) & = 0\\
        t_0 & = \frac{2\pi}{3}\\
    \end{align*}    
    \item \begin{align*}
        x[n] & = x[n + t_0] \\
        \cos[\frac{13\pi}{10}n] + \sin[\frac{7\pi}{10}n] & = \cos[\frac{13\pi}{10}(n + t_0)] + \sin[\frac{7\pi}{10}(n + t_0)] \\
        \sin[\frac{\pi}{2} - \frac{13\pi}{10}n] + \sin[\frac{7\pi}{10}n] & = \sin[\frac{\pi}{2} - \frac{13\pi}{10}(n + t_0)] + \sin[\frac{7\pi}{10}(n + t_0)] \\
        \sin[\frac{5\pi}{10} - \frac{13\pi}{10}n] + \sin[\frac{7\pi}{10}n] & = \sin[\frac{5 \pi}{10} - \frac{13\pi}{10}(n + t_0)] + \sin[\frac{7\pi}{10}(n + t_0)] \\
        \sin[\frac{\pi}{10} (13n - 5)] + \sin[\frac{7\pi}{10}n] & = \sin[\frac{\pi}{10}(13n + 13t_0 - 5)] + \sin[\frac{7\pi}{10}(n + t_0)] \\
        2\sin(\frac{\frac{\pi}{10} (13n - 5) + \frac{7\pi}{10}n}{2})\cos(\frac{\frac{\pi}{10} (13n - 5) - \frac{7\pi}{10}n}{2}) & \\
        = 2\sin(\frac{\frac{\pi}{10} (13n + 13t_0 - 5) + \frac{7\pi}{10}(n + t_0)}{2})\cos&(\frac{\frac{\pi}{10} (13n + 13t_0 - 5) - \frac{7\pi}{10}(n + t_0)}{2}) \\
        \sin(\frac{\pi}{20}(20n - 5))\cos(\frac{\pi}{20}(6n - 5)) & = \sin(\frac{\pi}{20}(20n + 20t_0 - 5))\cos(\frac{\pi}{20}(6n + 6t_0 - 5)) \\
        \sin(n\pi - \frac{\pi}{4})\cos(\frac{3n\pi}{10} - \frac{\pi}{4}) & = \sin(n\pi + t_0\pi - \frac{\pi}{4})\cos(\frac{3n\pi + 3t_0\pi}{10} - \frac{\pi}{4}) \\
    \end{align*}

    The smallest integer $t_0$ that satisfies the equation above is $t_0 = 20$.
	\item The signal is not periodic as there is no integer that satisfies the equation below.
    \begin{align*}
        \frac{1}{2}\cos(7n - 5) & = \frac{1}{2}\cos(7(n + t_0) - 5) \\
    \end{align*}
    \end{enumerate}

\item %write the solution of q5
    \begin{enumerate}
    \item $x(t) = u[t-1] - 3u[t-3] + u[t-4]$
    \newpage % start a new page so that the layout of the graph is not messed up.
    \item $\frac{dx(t)}{dt} = \delta(t-1) -3\delta(t-3) +\delta(t-4)$
        The graph of $\frac{dx(t)}{dt}$ is given below.
        \begin{center}
            \includegraphics*[width=0.5\textwidth]{assets/graphs/q5b.png}
        \end{center}
    \end{enumerate}    
    
\item %write the solution of q6
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q6a
    \item %write the solution of q6b
    \end{enumerate}
    
\item %write the solution of q7
    \begin{enumerate}
    \item \hfill\begin{minted}{python}
def decompose(signal_name):
    """Read the CSV file with the signal name, decompose the signal into even and odd components,
    and save the results as PNG files."""

    with open(signal_name + ".csv", "r", encoding="ascii") as file:
        data = [float(item) for item in file.read().split(",")]
    start = int(data[0])
    signal = data[1:]
    end = start + len(signal) - 1

    pyplot.title("Original Signal")
    pyplot.plot(range(start, end + 1), signal)
    pyplot.savefig(IMAGES_PATH + signal_name + "_original.png")
    pyplot.clf()

    if abs(start) > end:
        signal = signal + [0] * (abs(start) - end)
        end = -start
    else:
        signal = [0] * (end - abs(start)) + signal
        start = -end

    even = [(x + y) / 2 for x, y in zip(signal, signal[::-1])]
    odd = [(x - y) / 2 for x, y in zip(signal, signal[::-1])]

    pyplot.title("Even Component")
    pyplot.plot(range(start, end + 1), even)
    pyplot.savefig(IMAGES_PATH + signal_name + "_even.png")
    pyplot.clf()

    pyplot.title("Odd Component")
    pyplot.plot(range(start, end + 1), odd)
    pyplot.savefig(IMAGES_PATH + signal_name + "_odd.png")
    pyplot.clf()
\end{minted}

\begin{figure}[H]
    \centering
    \begin{subfigure}[t]{0.3\linewidth}
    \centering
        \caption{Original Signal}
        \includegraphics[width=1\linewidth]{assets/q7a/sine_part_a_original.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
    \centering
        \caption{Even Component}
        \includegraphics[width=1\linewidth]{assets/q7a/sine_part_a_even.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
    \centering
        \caption{Odd Component}
        \includegraphics[width=1\linewidth]{assets/q7a/sine_part_a_odd.png}
    \end{subfigure}
    \caption{Sinusoidal Signal Decomposition}
\end{figure}

\begin{figure}[h]
    \centering
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Original Signal}
        \includegraphics[width=1\linewidth]{assets/q7a/shifted_sawtooth_part_a_original.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Even Component}
        \includegraphics[width=1\linewidth]{assets/q7a/shifted_sawtooth_part_a_even.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Odd Component}
        \includegraphics[width=1\linewidth]{assets/q7a/shifted_sawtooth_part_a_odd.png}
    \end{subfigure}
    \caption{Shifted Sawtooth Signal Decomposition}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Original Signal}
        \includegraphics[width=1\linewidth]{assets/q7a/chirp_part_a_original.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Even Component}
        \includegraphics[width=1\linewidth]{assets/q7a/chirp_part_a_even.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Odd Component}
        \includegraphics[width=1\linewidth]{assets/q7a/chirp_part_a_odd.png}
    \end{subfigure}
    \caption{Chirp Signal Decomposition}
\end{figure}


    

    \item \hfill \begin{minted}{python}
class Signal:
    def __init__(self, signal, start, a, b):
        self.signal = signal
        self.start = start
        self.a = a
        self.b = b

    def __getitem__(self, index):
        return self.signal[self.a * index + self.b - self.start]


def shift_n_scale(signal_name):
    """
    Read the CSV file with the signal name, shift and scale the signal,
        and save the results as PNG files.

    This functions reads a signal x[n], and produces x[a*n + b] for a and b
    """

    with open(signal_name + ".csv", "r", encoding="ascii") as file:
        data = [float(item) for item in file.read().split(",")]
    start = int(data[0])
    a = int(data[1])
    b = int(data[2])
    signal = Signal(data[3:], start, a, b)
    end = start + len(signal.signal) - 1

    new_start = (start - b) // a
    new_end = (end - b) // a
    pyplot.xlim(new_start, new_end)

    pyplot.plot(range(start, end + 1), signal.signal,linewidth=1)

    if new_start > new_end:
        domain = range(new_start, new_end, -1)
    else:
        domain = range(new_start, new_end + 1)
    pyplot.plot(
        domain,
        [signal[i] for i in domain],
        linewidth=1,
    )
    pyplot.legend(
        ["x[n]", "x[" + str(a) + "n " + ("+" if b >= 0 else "") + str(b) + "]"],
        loc="lower right",
        fontsize=8,
    )
    pyplot.savefig(IMAGES_PATH + signal_name)
    pyplot.clf()
    \end{minted}
    \end{enumerate}    

\end{enumerate}

\begin{figure}[H]
    \centering
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Sinusoidal Signal}
        \includegraphics[width=1\linewidth]{assets/q7b/sine_part_b.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Shifted Sawtooth Signal}
        \includegraphics[width=1\linewidth]{assets/q7b/shifted_sawtooth_part_b.png}
    \end{subfigure}
    \begin{subfigure}[t]{0.3\linewidth}
        \centering
        \caption{Chirp Signal}
        \includegraphics[width=1\linewidth]{assets/q7b/chirp_part_b.png}
    \end{subfigure}
    \caption{Shift and Scale}
\end{figure}

\end{document}


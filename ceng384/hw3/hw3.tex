\documentclass[10pt,a4paper, margin=1in]{article}
\usepackage{fullpage}
\usepackage{amsfonts, amsmath, pifont}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{float}
\usepackage{minted}
\usepackage{tkz-euclide}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{svg}
\pgfplotsset{compat=1.13}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={210mm,297mm},
 left=10mm,
 right=10mm,
 top=10mm,
 bottom=10mm,
 }
 % Write both of your names here. Fill exxxxxxx with your ceng mail address.
 \author{
  Geçit, Emre\\
  \texttt{e2521581@ceng.metu.edu.tr}
  \and
  Yancı, Baran\\
  \texttt{e2449015@ceng.metu.edu.tr}
}

\title{CENG 384 - Signals and Systems for Computer Engineers \\
Spring 2023 \\
Homework 3}
\begin{document}
\maketitle



\noindent\rule{19cm}{1.2pt}

\begin{enumerate}

\item \begin{align*}
    \int_{-\infty}^t x(s) ds &= \int_{-\infty}^{t} \sum_{k=-\infty}^{\infty} a_k e^{jk\omega_0 s} ds\\
    &= \sum_{k=-\infty}^{\infty} (a_k \cdot \frac{e^{jkw_0t}}{jkw_0} \Big|_{-\infty}^{t})\\
    &= \sum_{k=-\infty}^{\infty} (a_k \cdot \frac{e^{jkw_0t}}{jkw_0} - a_k \cdot \frac{e^{jkw_0 (-\infty)}}{jkw_0})\\
    &= \sum_{k=-\infty}^{\infty} (a_k \cdot \frac{e^{jkw_0t}}{jkw_0} - a_k \cdot \frac{0}{jkw_0})\\
    &= \sum_{k=-\infty}^{\infty} (a_k \cdot \frac{e^{jkw_0t}}{jkw_0})\\
\end{align*}

This equation is in the synthesis equation form where $a_k \frac{1}{jkw_0}$ is the Fourier series coefficients of the integrated signal.\\

Since $w_0$ is the frequency of the signal, $w_0 = \frac{2\pi}{T}$ where $T$ is the period of the signal.\\

Substituting $w_0$ in the equation above, we prove the integration property of the Fourier series.\\

\item %write the solution of q2  
	\begin{enumerate}
    % Write your solutions in the following items.
    \item $x(t)x(t) \leftrightarrow a_k \ast a_k$ (Multiplication Property)
    \item $\mathcal{E}v\{x(t)\} \leftrightarrow b_k$ (Even Property) \[b_k= \begin{cases}
        a_k & k \geq 0 \\
        a_{-k} & k < 0
    \end{cases} \]
    \item $x(t+t_0) + x(t-t_0) \leftrightarrow a_k e^{jkw_0t_0} + a_{-k} e^{-jkw_0t_0} $ (Shifting and Linearity Properties)
    \end{enumerate}

\item
\[ x(t) = \begin{cases}
        2 & x \in (0, 1) \\
        0 & x \in (1, 2) \\
        -2 & x \in (2, 3) \\
        0 & x \in (3, 4) \\
        \text{Periodic} & x \notin (0, 4)
\end{cases}\]
\begin{align*}
    a_k &= \frac{1}{T} \int_{0}^{T} x(t) e^{-jkw_0t} dt \\
    &= \frac{1}{4} (\int_{0}^{1} 2e^{-jkw_0t} dt + \int_{1}^{2} 0 dt + \int_{2}^{3} -2 e^{-jkw_0t} dt + \int_{3}^{4} 0 dt) \\
    &= \frac{1}{4} (2\frac{e^{-jkw_0t}}{-jkw_0} \Big|_{0}^{1} - 2\frac{e^{-jkw_0t}}{-jkw_0} \Big|_{2}^{3}) \\
    &= \frac{1}{4} (2\frac{e^{-jkw_0}}{-jkw_0} - \frac{2}{-jkw_0} - 2\frac{e^{-3jkw_0}}{-jkw_0} + 2\frac{e^{-2jkw_0}}{-jkw_0}) \\
    &= \frac{1}{-2jkw_0} (e^{-jkw_0} - 1 - e^{-3jkw_0} + e^{-2jkw_0}) \\
\end{align*}
Substitute $w_0 = \frac{2\pi}{T} = \frac{2\pi}{4} = \frac{\pi}{2}$\\

\begin{align*}
    a_k &= \frac{1}{-2jk\frac{\pi}{2}} (e^{-jk\frac{\pi}{2}} - 1 - e^{-3jk\frac{\pi}{2}} + e^{-2jk\frac{\pi}{2}}) \\
    &= \frac{1}{-jk\pi} (e^{-jk\frac{\pi}{2}} - 1 - e^{-3jk\frac{\pi}{2}} + e^{-jk\pi}) \\
    &= \frac{1}{-jk\pi} (cos(-k\frac{\pi}{2}) + jsin(-k\frac{\pi}{2}) - 1 - cos(-3k\frac{\pi}{2}) - jsin(-3k\frac{\pi}{2}) + cos(-k\pi) + jsin(-k\pi)) \\
    &= \frac{1}{-jk\pi} (-2jsin(k\frac{\pi}{2}) - 1 + cos(-k\pi)) \\
\end{align*}


\item %write the solution of q4
    \begin{enumerate}   
    % Write your solutions in the following items.
    \item %write the solution of q4a
    \begin{align*}
        x(t) & = 1 + \sin(\omega_0t) + 2\cos(\omega_0t) + \cos(2\omega_0t + \frac{\pi}{4}) \\
        & = 1 + \sin(\omega_0t) + 2\cos(\omega_0t) + \cos(2\omega_0t)\cos(\frac{\pi}{4}) - \sin(2\omega_0t)\sin(\frac{\pi}{4}) \\
        & = 1 + \sin(\omega_0t) + 2\cos(\omega_0t) + \frac{\sqrt{2}}{2}\cos(2\omega_0t) - \frac{\sqrt{2}}{2}\sin(2\omega_0t) \\
        % use euler's formula
        & = 1 + \frac{e^{j\omega_0t} - e^{-j\omega_0t}}{2j} + 2\frac{e^{j\omega_0t} + e^{-j\omega_0t}}{2} + \frac{\sqrt{2}}{2}\frac{e^{j2\omega_0t} + e^{-j2\omega_0t}}{2} - \frac{\sqrt{2}}{2}\frac{e^{j2\omega_0t} - e^{-j2\omega_0t}}{2j} \\
        % rearrange
        & = 1 + \frac{1}{2j}e^{j\omega_0t} - \frac{1}{2j}e^{-j\omega_0t} + e^{j\omega_0t} + e^{-j\omega_0t} + \frac{\sqrt{2}}{4}e^{j2\omega_0t} + \frac{\sqrt{2}}{4}e^{-j2\omega_0t} - \frac{\sqrt{2}}{4j}e^{j2\omega_0t} + \frac{\sqrt{2}}{4j}e^{-j2\omega_0t} \\
    \end{align*}
    \begin{align*}
        \alpha_0 & = 1 \\
        \alpha_1 & = 1 + \frac{1}{2j}\\
        \alpha_{-1} & = 1 - \frac{1}{2j}\\
        \alpha_2 & = \frac{\sqrt{2}}{4} - \frac{\sqrt{2}}{4j}\\
        \alpha_{-2} & = \frac{\sqrt{2}}{4} + \frac{\sqrt{2}}{4j}\\
    \end{align*}

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-2, -1, 0, 1, 2},
        ytick=data,
        xlabel=$k$, 
        ylabel=$\theta_k$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-2.5, ymax=2.5]
        \addplot+[ycomb,mark=square] plot coordinates {(-2,1.57) (-1,-1.107) (0,1) (1,1.107) (2,-1.57)};
        \end{axis}
    \end{tikzpicture} \\

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-2, -1, 0, 1, 2},
        ytick=data,
        xlabel=$k$, 
        ylabel=$|a_k|$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-0.3, ymax=2.5]
        \addplot+[ycomb,mark=square] plot coordinates {(-2,0.5) (-1,1.118033989) (0,1) (1,1.118033989) (2,0.5)};
        \end{axis}
    \end{tikzpicture} \\

    \item %write the solution of q4b
    \begin{align*}
        x(t) & = e^{j\omega_0t} \\
        y(t) & = H(jk\omega_0)e^{jk\omega_0t} \\
        y'(t) + y(t) & = x(t) \\
        jk\omega_0H(jk\omega_0)e^{jk\omega_0t} & + H(jk\omega_0)e^{jk\omega_0t} & = e^{jk\omega_0t} \\
        H(jk\omega_0) & = \frac{1}{1 + jk\omega_0} \\
    \end{align*}
	\item %write the solution of q4c
    \begin{align*}
        y(t) = H(jk\omega_0)e^{jk\omega_0t} & = \frac{1}{1 + jk\omega_0}e^{jk\omega_0t} \\
        b_k & = a_k\frac{1}{1 + jk\omega_0} \\ 
        b_1 & = \frac{1 + \frac{1}{2j}}{1 + j\omega_0} \\
        b_{-1} & = \frac{1 - \frac{1}{2j}}{1 - j\omega_0} \\
        b_2 & = \frac{\frac{\sqrt{2}}{4} - \frac{\sqrt{2}}{4j}}{1 + 2j\omega_0} \\
        b_{-2} & = \frac{\frac{\sqrt{2}}{4} + \frac{\sqrt{2}}{4j}}{1 - 2j\omega_0} \\
    \end{align*}
    \item %write the solution of q4d
    % Write the expression for y(t).
    \begin{align*}
        y(t) & = \sum_{k=-\infty}^{\infty} b_k e^{jk\omega_0t} \\
        & = b_1 e^{j\omega_0t} + b_{-1} e^{-j\omega_0t} + b_2 e^{j2\omega_0t} + b_{-2} e^{-j2\omega_0t} \\
        & = \frac{1 + \frac{1}{2j}}{1 + j\omega_0} e^{j\omega_0t} + \frac{1 - \frac{1}{2j}}{1 - j\omega_0} e^{-j\omega_0t} + \frac{\frac{\sqrt{2}}{4} - \frac{\sqrt{2}}{4j}}{1 + 2j\omega_0} e^{j2\omega_0t} + \frac{\frac{\sqrt{2}}{4} + \frac{\sqrt{2}}{4j}}{1 - 2j\omega_0} e^{-j2\omega_0t} \\
    \end{align*}
    \end{enumerate}

\item %write the solution of q5
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q5a
    % find the Fourier series coefficients of x[n] = sin ((pi/2) * n)
    \begin{align*}
        x[n] & = sin(\frac{\pi}{2}n) \\
        & = \frac{e^{j\frac{\pi}{2}n} - e^{-j\frac{\pi}{2}n}}{2j} \\
        & = \frac{1}{2j}e^{j\frac{\pi}{2}n} - \frac{1}{2j}e^{-j\frac{\pi}{2}n} \\
        \alpha_1 & = \frac{1}{2j} \\
        \alpha_{-1} & = -\frac{1}{2j} \\
    \end{align*}
    \item %write the solution of q5b
    % find the Fourier series coefficients of y[n] = 1 + cos((pi/2) * n)
    \begin{align*}
        y[n] & = 1 + cos(\frac{\pi}{2}n) \\
        & = 1 + \frac{e^{j\frac{\pi}{2}n} + e^{-j\frac{\pi}{2}n}}{2} \\
        & = 1 + \frac{1}{2}e^{j\frac{\pi}{2}n} + \frac{1}{2}e^{-j\frac{\pi}{2}n} \\
        \alpha_0 & = 1 \\
        \alpha_1 & = \frac{1}{2} \\
        \alpha_{-1} & = \frac{1}{2} \\
    \end{align*}
	\item %write the solution of q5c
    % Using the multiplication property of the discrete time Fourier series, find the Fourier series coefficients of x[n]×y[n].
    \begin{align*}
        x[n]y[n] & \leftrightarrow \alpha_k \ast \beta_k \\
        & = \sum_{k=0}^{N - 1} \alpha_l \beta_{k - l} \\
        & = \sum_{k=0}^{3} \alpha_l \beta_{k - l} \\
        & = \alpha_0 \beta_{k - 0} + \alpha_1 \beta_{k - 1} + \alpha_2 \beta_{k - 2} + \alpha_3 \beta_{k - 3} \\
        c_k & = \frac{1}{2} \beta_{k - 1} + \frac{1}{2} \beta_{k - 3} \\
        &\\
        c_1 & = 0 \\
        c_2 & = \frac{-1}{2j}\\
        c_3 & = 0 \\
        c_4 & = \frac{1}{2j}\\
    \end{align*}
	\item %write the solution of q5d
    % Using Fourier analysis equation (direct evaluation), find the Fourier series coefficients of x[n] × y[n]. Compare the
    % result with the result of part c.
    \begin{align*}
        c_k & = \frac{1}{N} \sum_{n=0}^{N - 1} x[n]y[n]e^{-j\frac{2\pi}{N}kn} \\
        & = \frac{1}{4} \sum_{n=0}^{3} x[n]y[n]e^{-j\frac{2\pi}{4}kn} \\
        & = \frac{1}{4} (x[0]y[0]e^{-j\frac{2\pi}{4}k0} + x[1]y[1]e^{-j\frac{2\pi}{4}k1} + x[2]y[2]e^{-j\frac{2\pi}{4}k2} + x[3]y[3]e^{-j\frac{2\pi}{4}k3}) \\
        & = \frac{1}{4} (0 \cdot 2 \cdot e^{-j\frac{2\pi}{4}k0} + 1 \cdot 1 \cdot e^{-j\frac{2\pi}{4}k1} + 0 \cdot 0 \cdot e^{-j\frac{2\pi}{4}k2} + (-1) \cdot 1 \cdot e^{-j\frac{2\pi}{4}k3}) \\
        & = \frac{1}{4} (e^{-j\frac{2\pi}{4}k} - e^{-j\frac{2\pi}{4}k3}) \\
        c_1 & = 0 \\
        c_2 & = \frac{-1}{2j}\\
        c_3 & = 0 \\
        c_4 & = \frac{1}{2j}\\
    \end{align*}
    The results are the same.
    \end{enumerate}    
    
\item %write the solution of q6
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q6a
    % Find and plot the spectral coefficients of the Fourier series representation for the following discrete time signal, x[n]
    \begin{align*}
        x[n] & = 1 - \cos(\frac{n\pi}{2}) \\
        & = 1 - \frac{e^{j\frac{n\pi}{2}} + e^{-j\frac{n\pi}{2}}}{2} \\
        & = 1 - \frac{1}{2}e^{j\frac{n\pi}{2}} - \frac{1}{2}e^{-j\frac{n\pi}{2}} \\
        \alpha_0 & = 1 \\
        \alpha_1 & = -\frac{1}{2} \\
        \alpha_{-1} & = -\frac{1}{2} \\
    \end{align*}

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-1, 0, 1},
        ytick=data,
        xlabel=$k$, 
        ylabel=$|a_k|$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-2, ymax=1]
        \addplot+[ycomb,mark=square] plot coordinates {(-1,-0.5) (0,1) (1,-0.5)};
        \end{axis}
    \end{tikzpicture} \\

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-1, 0, 1},
        ytick=data,
        xlabel=$k$, 
        ylabel=$\theta_k$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-2, ymax=1]
        \addplot+[ycomb,mark=square] plot coordinates {(-1,1) (0,1) (1,1)};
        \end{axis}
    \end{tikzpicture} \\

    \item %write the solution of q6b
    \begin{enumerate}
        \item
        % Define y[n] in terms of x[n].
        \begin{align*}
            % TODO:
        \end{align*}

        \item \begin{align*}
            y[n] & = 1 + \sin(\frac{n\pi}{2}) - \cos(\frac{n\pi}{2}) \\
            & = 1 + \frac{e^{j\frac{n\pi}{2}} - e^{-j\frac{n\pi}{2}}}{2j} - \frac{e^{j\frac{n\pi}{2}} + e^{-j\frac{n\pi}{2}}}{2} \\
            & = 1 + \frac{1}{2j}e^{j\frac{n\pi}{2}} - \frac{1}{2j}e^{-j\frac{n\pi}{2}} - \frac{1}{2}e^{j\frac{n\pi}{2}} - \frac{1}{2}e^{-j\frac{n\pi}{2}} \\
            & = 1 - \frac{1}{2}e^{j\frac{n\pi}{2}} + \frac{1}{2j}e^{j\frac{n\pi}{2}} - \frac{1}{2j}e^{-j\frac{n\pi}{2}} - \frac{1}{2}e^{-j\frac{n\pi}{2}} \\
            \alpha_0 & = 1 \\
            \alpha_1 & = -\frac{1}{2} + \frac{1}{2j} \\
            \alpha_{-1} & = -\frac{1}{2} - \frac{1}{2j} \\
        \end{align*}

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-1, 0, 1},
        ytick=data,
        xlabel=$k$, 
        ylabel=$|a_k|$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-1, ymax=2]
        \addplot+[ycomb,mark=square] plot coordinates {(-1,1.414) (0,1) (1,1.414)};
        \end{axis}
    \end{tikzpicture} \\

    \begin{tikzpicture}
        \begin{axis}[ 
        /pgf/number format/fixed,
        /pgf/number format/precision=3,
        height=200,
        xtick = {-1, 0, 1},
        ytick=data,
        xlabel=$k$, 
        ylabel=$\theta_k$, 
        axis x line=center, 
        axis y line = center, 
        xmin=-2.5, xmax=2.5, ymin=-1, ymax=2]
        \addplot+[ycomb,mark=square] plot coordinates {(-1,1.25) (0,1) (1,0.75)};
        \end{axis}
    \end{tikzpicture} \\
    \end{enumerate}
    \end{enumerate}
    
\item %write the solution of q7
    \begin{enumerate}
    \item 
    \begin{align*}
        y(t) &= H(jk\omega_0) e^{jk\omega_0t} &&\text{Lecture Notes 6.8}\\
        x(t) &= \sum_{k=-\infty}^{+\infty} a_k e^{jk\omega_0t} \Rightarrow y(t) = \sum_{k=-\infty}^{+\infty}H(jk\omega_0) a_k e^{jk\omega_0t} && \text{Linearity Property}\\
        \omega_0 &= \frac{2\pi}{T} = \frac{2\pi}{\pi/K} = 2K\\
        y(t) &= \sum_{k=-\infty}^{+\infty}H(j2Kk) a_k e^{jk2Kt} && \text{Substitute $\omega_0$}\\
        y(t) &= \sum_{k=-40/K}^{+40/K} a_k e^{jk2Kt} && |\omega| \leq 80 \Rightarrow H(j\omega) = 1 \\
        \sum_{k=-40/K}^{+40/K} a_k e^{jk2Kt} &= \sum_{k=-\infty}^{+\infty} a_k e^{jk2Kt} && \text{x(t) = y(t)}
    \end{align*}
    In conclusion, $a_k = 0$ for $k \notin [-40/K, 40/K]$.
    \item Nothing can be concluded if $x(t) \neq y(t)$.
    \end{enumerate}    
	
\item \begin{enumerate}
    \item \inputminted{python}{q8a.py}
    \item \inputminted{python}{q8b.py}
    \item \inputminted{python}{q8c.py}
    \begin{figure}[H]
        \centering
        \caption{Approximated Square Wave with 1 Spectral Coefficient}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/square_wave_1.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Square Wave with 5 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/square_wave_5.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Square Wave with 10 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/square_wave_10.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Square Wave with 50 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/square_wave_50.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Square Wave with 100 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/square_wave_100.svg}
    \end{figure}
    \item \inputminted{python}{q8d.py}
    \begin{figure}[H]
        \centering
        \caption{Approximated Sawtooth Wave with 1 Spectral Coefficient}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/sawtooth_wave_1.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Sawtooth Wave with 5 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/sawtooth_wave_5.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Sawtooth Wave with 10 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/sawtooth_wave_10.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Sawtooth Wave with 50 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/sawtooth_wave_50.svg}
    \end{figure}
    \begin{figure}[H]
        \centering
        \caption{Approximated Sawtooth Wave with 100 Spectral Coefficients}
        \includesvg[inkscapelatex=false, width=0.5\textwidth]{figures/sawtooth_wave_100.svg}
    \end{figure}
    Although, increasing the number of spectral coefficients increases the accuracy of the approximation, there is a scaling difference between the original and the approximated wave. This is because the number of coefficients used is far less than the number of points in the original wave. For an accurate approximation, the number of coefficients should be equal to the number of points in a period of the original wave.
\end{enumerate}
\end{enumerate}


\end{document}
